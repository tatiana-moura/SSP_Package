-------------------------------------------------------
Package to calculate synthetic stellar spectra and SSPs
-------------------------------------------------------

The following files are included in the package:

REAMDE             -> this file
Manual.pdf         -> Manual
install.sh         -> script to compile the fortran codes

FORTRAN CODES:
 pfantgrade.f       -> main code that calculates stellar synthetic spectra
 pkapgeralgrade.f   -> required subroutines
 absor.f            -> required subroutines
 calhy.f            -> required subroutines
 hydro2.f           -> code that calculates hydrogen lines
 nulbadgrade.f      -> convolution code 

REQUIRED FILES:
 hydro2.prt         -> used by hydro2 
 absoru2_hydro2.dat -> used by hydro2  
 absoru2_pfant.dat  -> used by pfantgrade
 partit.dat         -> partition functions used by pfantgrade
 atomgrade.dat      -> list of atomic lines
 moleculagrade.dat  -> molecular data
 abonds_Sun.dat     -> solar abundances 
 dissoc_Sun.dat     -> solar abundances (file used for molecules)

R SCRIPTS:
 stpars.R           -> selects stellar parameters along a isochrone
 pfant12.R          -> calls the PFANT code to calculate the synthetic stellar spectra
 SSP_model.R        -> creates the SSP spectra
 test.R             -> script to test the package
 example.R          -> example of how to calculate SSP spectra

Iku1.30Zp0.22T08.9125 -> MIUSCAT spectrum for comparison (used by test.R and example.R)

MODEL ATMOSPHERES:
 /atm_models/innewmarcs2_grid_dwarfs2.f       -> code to interpolate grid 3.0 < logg < 5.0, 2900 < Teff < 8000 K
 /atm_models/innewmarcs2_grid_giants_g_gt_1.f -> code to interpolate grid 1.0 < logg < 3.0, 2600 < Teff < 5250 K
 /atm_models/innewmarcs2_grid_giants_g_lt_1.f -> code to interpolate grid -0.5 < logg < 1.0, 3300 < Teff < 3900 K
 /atm_models/marcs2009*.mod

ISOCHRONES (http://stellar.dartmouth.edu/models/index.html)
 /DARTMOUTH/iso_interp_feh.f  -> interpolation in [Fe/H] at fixed [a/Fe], Y, and age
 /DARTMOUTH/isolf_split.f     -> separates a file containing multiple ages into a number of individual files
 /DARTMOUTH/isochrones/       -> isochones

-----------------------------
Compiling the codes
-----------------------------
  > ./install.sh

-----------------------------
Testing the package
-----------------------------
The scripts that call the fortran codes are all written in R, so you need the
r-base installed in your computer. 

To check if everything is working properly, you can run a very simple test script.
In R environment, do:

  >>> source('test.R')

The script test.R produces a SSP in the region 8400-8600 A, and takes a 
few minutes to run. 

If it is working, then you can try the script example.R, which shows how to create
SSP spectra with different abundance ratios and IMFs. The functions used in this 
script are described in the Manual.pdf

-------------------------------
IMPORTANT!!!
-------------------------------

THE CONTINUUM OF THE STELLAR SPECTRA AND SSP MODELS IS NOT ACCURATE AT LAMBDA < 5000 A

   The color predictions by PFANT code are inaccurate in the blue part of the spectrum, 
   in particular at lambda < 5000A. That occurs because the so-called "predicted lines"
   (Kurucz 1992 Rev. Mex. Astron. Astrofis., 23, 45), are not included in the calculations, due to the
   high uncertainties in the detemination of the energy levels of these lines (see Coelho et al.
   2007 for further details). The codes available in this distribution do not apply *any* flux correction, 
   and as a consequence, the continuum of the SSP models is not accurate at lambda < 5000 A.


THERE IS A VERY SMALL INACCURACY IN LAMBDA
   
   The spectra calculated by the PFANT code have a very small inaccuracy in lambda. This effect is negligible
   when calculating spectra for a narrow wavelength range, but it can be important when calculating the spectra 
   for a wide range in lambda (such as 3500-9000A). 
   This effect is cumulative, and can be easily corrected by doing something like:
     dd = delta       # delta ~ 0.004 A, for 0.1 A/pixel sampling
     for(j in 1:length(lambda)){del[j] = dd * j}
     lambda_corrected = lambda - del
   This issue will be corrected in further versions of the PFANT code.


NO ATTEMPT WAS MADE TO MAKE THE PACKAGE WORK FOR LAMBDA > 9000 A.
    
   
################

Written: Marina Trevisan 
Last updated: 19 January 2015


